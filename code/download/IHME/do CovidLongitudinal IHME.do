
clear all

cd "$pathCovidLongitudinal/download/IHME"

capture log close 

log using "log CovidLongitudinal IHME.smcl", replace

***************************************************************************
* This is "do CovidLongitudinal IHME.do"

* Project: Longitudinal assessment of COVID-19 models

* Objective: Download estimates files for IHME model                                                                   
***************************************************************************


* download and prepare estimates files
* input data files: download csv files
* output data files: "IHME202?????.dta" 
*                    "IHME countries.dta"
*                    "IHME countries long.dta"



* based on combinations of |linkdate, |download, and |urldate
* e.g., 				   |04-Nov-21 |ihme-covid19  |2021-11-04
* https://ihmecovid19storage.blob.core.windows.net/archive/2021-11-04/ihme-covid19.zip data_download_file_reference_2020


/*
Explanation of "linkdate", "download", and "urldate":

"linkdate" is the date of update as shown on web page https://www.healthdata.org/node/8787 titled "COVID-19 estimate downloads | Archive", that mentions "Archive dates correspond to the update in the projections tool with most recent data, which may differ from the date listed on the downloaded file." 

"linkdate" is the "update date" here.

"download" is the name of the directory that is created after downloading the files and unzipped. Later updates do not create a directory and the files get downloaded directly to the root of -present working directory- that is /IHME/.

"download" is used here with command -cd- to change directory to the created directory (and later, -cd ..- is used to come back to the root /IHME/.

"urldate" is the date mentioned in the URL of the update.

"urldate" is used in the download URL here. 
*/






/*

IHME updates ("urldate")

1	  	March 25, 2020 
2	  	March 26, 2020 
3	  	March 27, 2020 
4	  	March 29, 2020 
5	  	March 30, 2020 
6	  	March 31, 2020 
7	  	April 1, 2020 
8	  	April 5, 2020 
9	  	April 7, 2020 
10	  	April 8, 2020 
11	  	April 10, 2020 
12	  	April 13, 2020 
13	  	April 17, 2020 
14	  	April 21, 2020 
15	  	April 22, 2020 
16	  	April 27, 2020 
17	  	April 28, 2020 
18	  	April 29, 2020 
19	  	May 4, 2020 
20	  	May 10, 2020 
21	  	May 12, 2020 
22	  	May 20, 2020 
23	  	May 25, 2020 
24	  	May 26, 2020 
25	  	May 29, 2020 
26	  	June 5, 2020 
27	  	June 8, 2020 
28	  	June 10, 2020 
29	  	June 15, 2020 
30	  	June 25, 2020 
31	  	June 29, 2020 
32	  	July 7, 2020 
33	  	July 14, 2020 
34	  	July 22, 2020 
35	  	July 30, 2020 
36	  	August 06, 2020 
37	  	August 21, 2020 
38	  	August 27, 2020 
39	  	September 03, 2020 
40	  	September 11, 2020 
41	  	September 18, 2020 
42	  	September 24, 2020 
43	  	October 2, 2020 
44	  	October 9, 2020 
45	  	October 15, 2020 
46	  	October 22, 2020 
47	  	October 29, 2020 
48	  	November 12, 2020 
49	  	November 19, 2020 
50	  	December 3, 2020 
51	  	December 10, 2020 
52	  	December 17, 2020 
53	  	December 23, 2020
54	  	January 15, 2021 
55	  	January 22, 2021 
56	  	January 28, 2021 
57	  	February 4, 2021 
58	  	February 12, 2021 
59	  	February 20, 2021 
60	  	February 25, 2021 
61	  	March 6, 2021 
62	  	March 11, 2021 
63	  	March 17, 2021 
64	  	March 25, 2021 
65	  	April 1, 2021 
66	  	April 9, 2021 
67	  	April 16, 2021 
68	  	April 23, 2021 

	  	April 30, 2021 * The reference scenario "reference_hospitalization_all_locs.csv" was omitted from IHME website after original release. 
		
69	  	May 6, 2021 
70	  	May 14, 2021 
71	  	May 21, 2021
72	  	May 28, 2021
73	  	June 4, 2021
74	  	June 10, 2021
75	  	June 18, 2021
76	  	June 25, 2021 
77	  	July 2, 2021
78	  	July 15, 2021 
79	  	July 23, 2021 
80	  	July 30, 2021 
81	  	August 6, 2021 
82	  	August 20, 2021 
83	  	August 26, 2021 
84	  	September 2, 2021 
85	  	September 10, 2021 
86	  	September 16, 2021 
87	  	September 23, 2021 
88	  	September 30, 2021 
89	  	October 15, 2021 
90	  	October 21, 2021 
91	  	November 4, 2021 
92	  	November 19, 2021 
93	  	December 21, 2021 
94	  	January 8, 2022 
95	  	January 14, 2022 
96	  	January 21, 2022 
97	  	February 4, 2022 
98	  	February 18, 2022 
99	  	March 21, 2022 
100	  	April 8, 2022 
101	  	May 6, 2022 
102	  	June 10, 2022 
103	  	July 19, 2022
104	  	September 12, 2022
105		October 24, 2022
		
*/







grstyle init

grstyle color background white



capture shell rm -r "ihme-covid19.zip"









**********************************************
**********************************************
**********************************************

* update 1
* linkdate		download		urldate
* 2020-03-25 	ihme-covid19	2020-03-25 
* filename ihme-covid19_all_locs.csv
* cd


clear 


di in red "This is IHME urldate 2020-03-25" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-03-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "ihme-covid19"

import delimited using "ihme-covid19_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200325 DayDeaMeRaIHME20200325)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200325)

qui compress

cd ..

save "IHME 20200325.dta", replace





* get all countries

use "IHME 20200325.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200325.dta", replace


shell rm -r "ihme-covid19"


*
***



















**********************************************
**********************************************
**********************************************

* update 2
* linkdate		download		urldate
* 2020-03-26 	2020_03_26		2020-03-26 
* filename hospitalization_all_locs_corrected.csv
* cd


clear 


di in red "This is IHME urldate 2020-03-26" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-03-26/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_03_26"

import delimited using "hospitalization_all_locs_corrected.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200326 DayDeaMeRaIHME20200326)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200326)

qui compress

cd ..

save "IHME 20200326.dta", replace





* get all countries

use "IHME 20200326.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200326.dta", replace



shell rm -r "2020_03_26"


*
***

















**********************************************
**********************************************
**********************************************

* update 3
* linkdate		download		urldate
* 2020-03-27 	2020_03_27		2020-03-27 
* filename hospitalization_all_locs_corrected.csv
* cd


clear 


di in red "This is IHME urldate 2020-03-27" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-03-27/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_03_27"

import delimited using "hospitalization_all_locs_corrected.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200327 DayDeaMeRaIHME20200327)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200327)

qui compress

cd ..

save "IHME 20200327.dta", replace





* get all countries

use "IHME 20200327.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200327.dta", replace


shell rm -r "2020_03_27"


*
***


















**********************************************
**********************************************
**********************************************

* update 4
* linkdate		download		urldate
* 2020-03-29 	2020_03_29		2020-03-29 
* filename hospitalization_all_locs_corrected.csv
* cd


clear 


di in red "This is IHME urldate 2020-03-29" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-03-29/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_03_29"

import delimited using "hospitalization_all_locs_corrected.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200329 DayDeaMeRaIHME20200329)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200329)

qui compress

cd ..

save "IHME 20200329.dta", replace





* get all countries

use "IHME 20200329.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200329.dta", replace




shell rm -r "2020_03_29"


*
***

















**********************************************
**********************************************
**********************************************

* update 5
* linkdate		download		urldate
* 2020-03-30 	2020_03_30		2020-03-30 
* filename Hospitalization_all_locs.csv
* cd


clear 


di in red "This is IHME urldate 2020-03-30" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-03-30/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_03_30"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200330 DayDeaMeRaIHME20200330)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200330)

qui compress

cd ..

save "IHME 20200330.dta", replace





* get all countries

use "IHME 20200330.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


replace location_name = "United States of America" if location_name == "US" 


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200330.dta", replace




shell rm -r "2020_03_30"


*
***

















**********************************************
**********************************************
**********************************************

* update 6
* linkdate		download		urldate
* 2020-03-31 	2020_03_31.1		2020-03-31 
* filename Hospitalization_all_locs.csv
* cd


clear 


di in red "This is IHME urldate 2020-03-31" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-03-31/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_03_31.1"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200331 DayDeaMeRaIHME20200331)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200331)

qui compress

cd ..

save "IHME 20200331.dta", replace





* get all countries

use "IHME 20200331.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


replace location_name = "United States of America" if location_name == "US" 


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200331.dta", replace



shell rm -r "2020_03_31.1"


*
***




















**********************************************
**********************************************
**********************************************

* update 7
* linkdate		download		urldate
* 2020-04-01 	2020_04_01.2		2020-04-01 
* filename Hospitalization_all_locs.csv
* cd


clear 


di in red "This is IHME urldate 2020-04-01" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-01/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_01.2"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200401 DayDeaMeRaIHME20200401)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200401)

qui compress

cd ..

save "IHME 20200401.dta", replace





* get all countries

use "IHME 20200401.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


replace location_name = "United States of America" if location_name == "US" 


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200401.dta", replace




shell rm -r "2020_04_01.2"


*
***

















**********************************************
**********************************************
**********************************************

* update 8
* linkdate		download		urldate
* 2020-04-05 	2020_04_05.05.us		2020-04-05 
* filename Hospitalization_all_locs.csv
* cd


clear 


di in red "This is IHME urldate 2020-04-05" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-05/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_05.05.us"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200405 DayDeaMeRaIHME20200405)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200405)

qui compress

cd ..

save "IHME 20200405.dta", replace





* get all countries

use "IHME 20200405.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


replace location_name = "United States of America" if location_name == "US" 


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200405.dta", replace



shell rm -r "2020_04_05.05.us"


*
***











**********************************************
**********************************************
**********************************************

* update 9
* linkdate		download		urldate
* 2020-04-07 	2020_04_05.08.all		2020-04-07 
* filename Hospitalization_all_locs.csv
* cd

* From 2020-04-07 some countries (and subnational levels) other than the United States are added.

* No country of Georgia yet, no Cote d'Ivoire yet

clear 

di in red "This is IHME urldate 2020-04-07" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-07/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_05.08.all"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200407 DayDeaMeRaIHME20200407)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200407)

qui compress

cd ..

save "IHME 20200407.dta", replace





* get all countries

use "IHME 20200407.dta", clear

drop if location_name == "Georgia" // Georgia state

keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200407.dta", replace


shell rm -r "2020_04_05.08.all"

*
***










**********************************************
**********************************************
**********************************************

* update 10
* linkdate		download		urldate
* 2020-04-08 	2020_04_07.06.all		2020-04-08 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet

clear 


di in red "This is IHME urldate 2020-04-08" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-08/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_07.06.all"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


drop if location_name == "Georgia" // Georgia state




* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200408 DayDeaMeRaIHME20200408)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200408)

qui compress

cd ..

save "IHME 20200408.dta", replace





* get all countries

use "IHME 20200408.dta", clear

drop if location_name == "Georgia" // Georgia state

keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200408.dta", replace



shell rm -r "2020_04_07.06.all"


*
***












**********************************************
**********************************************
**********************************************

* update 11
* linkdate		download		urldate
* 2020-04-10 	2020_04_09.04		2020-04-10 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet

clear 


di in red "This is IHME urldate 2020-04-10" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_09.04"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200410 DayDeaMeRaIHME20200410)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200410)

qui compress

cd ..

save "IHME 20200410.dta", replace





* get all countries

use "IHME 20200410.dta", clear

drop if location_name == "Georgia" // Georgia state

keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200410.dta", replace



shell rm -r "2020_04_09.04"

*
***












**********************************************
**********************************************
**********************************************

* update 12
* linkdate		download		urldate
* 2020-04-13 	2020_04_12.02		2020-04-13 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet

clear 


di in red "This is IHME urldate 2020-04-13" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-13/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_12.02"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"

drop if location_name == "Georgia" // Georgia state




* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200413 DayDeaMeRaIHME20200413)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200413)

qui compress

cd ..

save "IHME 20200413.dta", replace





* get all countries

use "IHME 20200413.dta", clear

drop if location_name == "Georgia" // Georgia state

keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200413.dta", replace


shell rm -r "2020_04_12.02"


*
***












**********************************************
**********************************************
**********************************************

* update 13
* linkdate		download		urldate
* 2020-04-17 	2020_04_16.05		2020-04-17 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-04-17" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-17/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_16.05"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200417 DayDeaMeRaIHME20200417)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200417)

qui compress

cd ..

save "IHME 20200417.dta", replace





* get all countries

use "IHME 20200417.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200417.dta", replace



shell rm -r "2020_04_16.05"


*
***













**********************************************
**********************************************
**********************************************

* update 14
* linkdate		download		urldate
* 2020-04-21 	2020_04_20.02.all		2020-04-21 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-04-21" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-21/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_20.02.all"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200421 DayDeaMeRaIHME20200421)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200421)

qui compress

cd ..

save "IHME 20200421.dta", replace





* get all countries

use "IHME 20200421.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200421.dta", replace



shell rm -r "2020_04_20.02.all"


*
***













**********************************************
**********************************************
**********************************************

* update 15
* linkdate		download		urldate
* 2020-04-22 	2020_04_21.08		2020-04-22 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-04-22" 

copy https://www.healthdata.org/sites/default/files/files/Projects/COVID/ihme-covid19-0422.zip ihme-covid19-0422.zip
unzipfile ihme-covid19-0422.zip, replace
erase ihme-covid19-0422.zip

cd "2020_04_21.08"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200422 DayDeaMeRaIHME20200422)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200422)

qui compress

cd ..

save "IHME 20200422.dta", replace





* get all countries

use "IHME 20200422.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200422.dta", replace



shell rm -r "2020_04_21.08"


*
***













**********************************************
**********************************************
**********************************************

* update 16
* linkdate		download		urldate
* 2020-04-27 	2020_04_26.08		2020-04-27 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-04-27" 

copy https://www.healthdata.org/sites/default/files/files/Projects/COVID/downloads_0427.zip downloads_0427.zip
unzipfile downloads_0427.zip, replace
erase downloads_0427.zip

cd "2020_04_26.08"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200427 DayDeaMeRaIHME20200427)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200427)

qui compress

cd ..

save "IHME 20200427.dta", replace





* get all countries

use "IHME 20200427.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200427.dta", replace



shell rm -r "2020_04_26.08"


*
***














**********************************************
**********************************************
**********************************************

* update 17
* linkdate		download		urldate
* 2020-04-28 	2020_04_27.05.c		2020-04-28 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet

clear 


di in red "This is IHME urldate 2020-04-28" 

copy https://www.healthdata.org/sites/default/files/files/Projects/COVID/Downloads_0428.zip Downloads_0428.zip
unzipfile Downloads_0428.zip, replace
erase Downloads_0428.zip

cd "2020_04_27.05.c"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME  // location_id DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200428 DayDeaMeRaIHME20200428)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200428)

qui compress

cd ..

save "IHME 20200428.dta", replace





* get all countries

use "IHME 20200428.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200428.dta", replace


shell rm -r "2020_04_27.05.c"


*
***













**********************************************
**********************************************
**********************************************

* update 18
* linkdate		download		urldate
* 2020-04-29 	2020_04_28.02		2020-04-29 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-04-29" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-04-29/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_04_28.02"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200429 DayDeaMeRaIHME20200429)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200429)

qui compress

cd ..

save "IHME 20200429.dta", replace





* get all countries

use "IHME 20200429.dta", clear


drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200429 = . if date > td(01Oct2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200429.dta", replace



shell rm -r "2020_04_28.02"


*
***













**********************************************
**********************************************
**********************************************

* update 19
* linkdate		download		urldate
* 2020-05-04 	2020_05_04		2020-05-04 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-04" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-04/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_04"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200504 DayDeaMeRaIHME20200504)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200504)

qui compress

cd ..

save "IHME 20200504.dta", replace





* get all countries

use "IHME 20200504.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200504 = . if date > td(01Oct2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200504.dta", replace



shell rm -r "2020_05_04"


*
***













**********************************************
**********************************************
**********************************************

* update 20
* linkdate		download		urldate
* 2020-05-10 	2020_05_08		2020-05-10 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-10" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_08"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200510 DayDeaMeRaIHME20200510)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200510)

qui compress

cd ..

save "IHME 20200510.dta", replace





* get all countries

use "IHME 20200510.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



replace DayDeaMeSmIHME20200510 = . if date > td(01Oct2020) // if zero daily deaths at the end



qui compress

save "IHME all countries 20200510.dta", replace



shell rm -r "2020_05_08"


*
***












**********************************************
**********************************************
**********************************************

* update 21
* linkdate		download		urldate
* 2020-05-12 	2020_05_10		2020-05-12 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-12" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-12/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_10"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200512 DayDeaMeRaIHME20200512)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200512)

qui compress

cd ..

save "IHME 20200512.dta", replace





* get all countries

use "IHME 20200512.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



replace DayDeaMeSmIHME20200512 = . if date > td(01Oct2020) // if zero daily deaths at the end



qui compress

save "IHME all countries 20200512.dta", replace



shell rm -r "2020_05_10"


*
***













**********************************************
**********************************************
**********************************************

* update 22
* linkdate		download		urldate
* 2020-05-20 	2020_05_19		2020-05-20 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-20" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-20/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_19"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200520 DayDeaMeRaIHME20200520)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200520)

qui compress

cd ..

save "IHME 20200520.dta", replace





* get all countries

use "IHME 20200520.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200520 = . if date > td(01Oct2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200520.dta", replace



shell rm -r "2020_05_19"


*
***













**********************************************
**********************************************
**********************************************

* update 23
* linkdate		download		urldate
* 2020-05-25 	2020_05_23		2020-05-25 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-25" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_23"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200525 DayDeaMeRaIHME20200525)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200525)

qui compress

cd ..

save "IHME 20200525.dta", replace





* get all countries

use "IHME 20200525.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200525 = . if date > td(01Oct2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200525.dta", replace



shell rm -r "2020_05_23"


*
***













**********************************************
**********************************************
**********************************************

* update 24
* linkdate		download		urldate
* 2020-05-26 	2020_05_23.03		2020-05-26 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-26" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-26/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_23.03"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed / is named deaths_mean
rename deaths_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200526 DayDeaMeRaIHME20200526)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200526)

qui compress

cd ..

save "IHME 20200526.dta", replace





* get all countries

use "IHME 20200526.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200526 = . if date > td(01Oct2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200526.dta", replace



shell rm -r "2020_05_23.03"


*
***













**********************************************
**********************************************
**********************************************

* update 25
* linkdate		download		urldate
* 2020-05-29 	2020_05_28		2020-05-29 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-05-29" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-05-29/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_05_28"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


* There is a new variable, deaths_mean, with values of zero (or close to zero) up to 
*  up to one (or few) day/s before the update date, when the values are non-zero.
* This var is used for guiding the identification of the epoch date. 

* The values of the variable, deaths_mean_smoothed, become missing on the
*  on the same day that the values of the variable, deaths_mean, become non-zero.
* Hence, these two variables together make the full range of dates for the estimates of daily deaths. 

replace DayDeaMeSmIHME = deaths_mean if DayDeaMeSmIHME == . 




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME deaths_mean // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200529 DayDeaMeRaIHME20200529)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200529)

qui compress

cd ..

save "IHME 20200529.dta", replace





* get all countries

use "IHME 20200529.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200529 = . if date > td(01Oct2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200529.dta", replace



shell rm -r "2020_05_28"


*
***













**********************************************
**********************************************
**********************************************

* update 26
* linkdate		download		urldate
* 2020-06-05 	2020_06_03		2020-06-05 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet

/* IHME 20200605 includes a location_name value of Georgia_two without any other Georgia_one or Georgia. 
This should be the US state of Georgia, given the similarity of the daily deaths’ graph of 20200605 
with those of the previous and next updates. */



clear 


di in red "This is IHME urldate 2020-06-05" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-06-05/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_06_03"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed / is not available yet
//rename deaths_mean  DayDeaMeRaIHME
//label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


* There is a new variable, deaths_mean, with values of zero (or close to zero) up to 
*  up to one (or few) day/s before the update date, when the values are non-zero.
* This var is used here for guiding the identification of the epoch date. 

* The values of the variable, deaths_mean_smoothed, become missing on the
*  on the same day that the values of the variable, deaths_mean, become non-zero.
* Hence, these two variables together make the full range of dates for the estimates of daily deaths. 

replace DayDeaMeSmIHME = deaths_mean if DayDeaMeSmIHME == . 




* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia_two" // the Georgia state in USA


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME deaths_mean // location_id // DayDeaMeRaIHME

// rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200605 DayDeaMeRaIHME20200605)
rename (DayDeaMeSmIHME) (DayDeaMeSmIHME20200605)

qui compress

cd ..

save "IHME 20200605.dta", replace





* get all countries

use "IHME 20200605.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia_two" // the Georgia state in USA

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


replace DayDeaMeSmIHME20200605 = . if date > td(01Sep2020) // if zero daily deaths at the end


qui compress

save "IHME all countries 20200605.dta", replace



shell rm -r "2020_06_03"


*
***













**********************************************
**********************************************
**********************************************

* update 27
* linkdate		download		urldate
* 2020-06-08 	2020_06_06		2020-06-08 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet

clear 


di in red "This is IHME urldate 2020-06-08" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-06-08/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_06_06"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"






* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200608 DayDeaMeRaIHME20200608)

qui compress

cd ..

save "IHME 20200608.dta", replace





* get all countries

use "IHME 20200608.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200608.dta", replace



shell rm -r "2020_06_06"


*
***












**********************************************
**********************************************
**********************************************

* update 28
* linkdate		download		urldate
* 2020-06-10 	2020_06_08		2020-06-10 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-06-10" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-06-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_06_08"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"





* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200610 DayDeaMeRaIHME20200610)

qui compress

cd ..

save "IHME 20200610.dta", replace





* get all countries

use "IHME 20200610.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200610.dta", replace



shell rm -r "2020_06_08"


*
***











**********************************************
**********************************************
**********************************************

* update 29
* linkdate		download		urldate
* 2020-06-15 	2020_06_13		2020-06-15 
* filename Hospitalization_all_locs.csv
* cd

* No country of Georgia yet, no Cote d'Ivoire yet


clear 


di in red "This is IHME urldate 2020-06-15" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-06-15/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_06_13"

import delimited using "Hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



* The country Georgia, not the Georgia state in USA

// drop if location_id == 533 // the Georgia state in USA


* * for help in Identifying Georgia country and state in next update

tabstat DayDeaMeSmIHME if location_name == "Georgia" // 42.08122, update 20200615


drop if location_name == "Georgia" // Georgia state



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200615 DayDeaMeRaIHME20200615)

qui compress

cd ..

save "IHME 20200615.dta", replace







* get all countries

use "IHME 20200615.dta", clear


// drop if location_id == 533 // the Georgia state in USA

drop if location_name == "Georgia" // Georgia state

// replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200615.dta", replace



shell rm -r "2020_06_13"


*
***











**********************************************
**********************************************
**********************************************

* update 30
* linkdate		download		urldate
* 2020-06-25 	2020_06_24.02		2020-06-25 
* filename Reference_hospitalization_all_locs.csv
* cd

********************************************************************************************
* Country of Georgia is added; Cote d'Ivoire is added **************************************
********************************************************************************************


clear 


di in red "This is IHME urldate 2020-06-25" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-06-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_06_24.02"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace location_name = "Cote d'Ivoire" if regexm(location_name,"Ivoire") == 1


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200625 DayDeaMeRaIHME20200625)



qui compress

cd ..

save "IHME 20200625.dta", replace




* * Identify Georgia country and state

use "IHME 20200625.dta", replace

keep if location_name == "Georgia"

gen counter = _n

gen one_or_two = 1

replace one_or_two = 2 if mod(counter, 2) == 0 // if counter is even

tabstat DayDeaMeSmIHME20200625, by(one_or_two)

* one_or_two|      mean
*         1 |  .0537254
*         2 |  27.44445


* We know from above lines that -tabstat DayDeaMeSmIHME if location_name == "Georgia"- // 42.08122 in update 20200615

* Therefore, location_name == "Georgia" & one_or_two == 1 is Georgia country
* and location_name == "Georgia" & one_or_two == 2 is Georgia state.

* do not save.




* apply to the whole file IHME 20200625

use "IHME 20200625.dta", clear


gen counter = _n

gen one_or_two = 1

replace one_or_two = 2 if mod(counter, 2) == 0 // if counter is even

tabstat DayDeaMeSmIHME20200625 if location_name == "Georgia", by(one_or_two) 

drop if location_name == "Georgia" & one_or_two == 2 // this is the state of Georgia

save "IHME 20200625.dta", replace






* get all countries

use "IHME 20200625.dta", clear

* * Georgia and Cote d'Ivoire accounted for in lines above.

keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200625.dta", replace



shell rm -r "2020_06_24.02"


*
***











**********************************************
**********************************************
**********************************************

* update 31
* linkdate		download		urldate
* 2020-06-29 	2020_06_27		2020-06-29 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id not present

clear 


di in red "This is IHME urldate 2020-06-29" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-06-29/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_06_27"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200629 DayDeaMeRaIHME20200629)

qui compress

cd ..

save "IHME 20200629.dta", replace




*** account for Georgia and Cote d'Ivoire

use "IHME 20200629.dta", clear

replace location_name = "Cote d'Ivoire" if regexm(location_name,"Ivoire") == 1

gen counter = _n

gen one_or_two = 1

replace one_or_two = 2 if mod(counter, 2) == 0 // if counter is even

tabstat DayDeaMeSmIHME20200629 if location_name == "Georgia", by(one_or_two) 

drop if location_name == "Georgia" & one_or_two == 2 // this is the state of Georgia

save "IHME 20200629.dta", replace





* get all countries

use "IHME 20200629.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200629.dta", replace



shell rm -r "2020_06_27"


*
***











**********************************************
**********************************************
**********************************************

* update 32
* linkdate		download		urldate
* 2020-07-07 	2020_07_04		2020-07-07 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id not present

clear 


di in red "This is IHME urldate 2020-07-07" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-07-07/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_07_04"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200707 DayDeaMeRaIHME20200707)

qui compress

cd ..

save "IHME 20200707.dta", replace





*** account for Georgia and Cote d'Ivoire

use "IHME 20200707.dta", clear

replace location_name = "Cote d'Ivoire" if regexm(location_name,"Ivoire") == 1

gen counter = _n

gen one_or_two = 1

replace one_or_two = 2 if mod(counter, 2) == 0 // if counter is even

tabstat DayDeaMeSmIHME20200707 if location_name == "Georgia", by(one_or_two) 

drop if location_name == "Georgia" & one_or_two == 2 // this is the state of Georgia

save "IHME 20200707.dta", replace





* get all countries

use "IHME 20200707.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200707.dta", replace


shell rm -r "2020_07_04"


*
***











**********************************************
**********************************************
**********************************************

* update 33
* linkdate		download		urldate
* 2020-07-14 	2020_07_11		2020-07-14 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present


clear 


di in red "This is IHME urldate 2020-07-14" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-07-14/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_07_11"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205





* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200714 DayDeaMeRaIHME20200714)

qui compress

cd ..

save "IHME 20200714.dta", replace





* get all countries

use "IHME 20200714.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200714.dta", replace



shell rm -r "2020_07_11"


*
***











**********************************************
**********************************************
**********************************************

* update 34
* linkdate		download		urldate
* 2020-07-22 	2020_07_18		2020-07-22 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present


clear 


di in red "This is IHME urldate 2020-07-22" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-07-22/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_07_18"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205





* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME // location_id

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200722 DayDeaMeRaIHME20200722)

qui compress

cd ..

save "IHME 20200722.dta", replace





* get all countries

use "IHME 20200722.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200722.dta", replace



shell rm -r "2020_07_18"


*
***











**********************************************
**********************************************
**********************************************

* update 35
* linkdate		download		urldate
* 2020-07-30 	2020_07_26		2020-07-30 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present

clear 


di in red "This is IHME urldate 2020-07-30" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-07-30/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_07_26"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed 
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME location_id // 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200730 DayDeaMeRaIHME20200730)

qui compress

cd ..

save "IHME 20200730.dta", replace





* get all countries

use "IHME 20200730.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.

keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200730.dta", replace



shell rm -r "2020_07_26"


*
***











**********************************************
**********************************************
**********************************************

* update 36
* linkdate		download		urldate
* 2020-08-06 	2020_08_06		2020-08-06 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present

clear 


di in red "This is IHME urldate 2020-08-06" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-08-06/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_08_06"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME location_id

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200806 DayDeaMeRaIHME20200806)

qui compress

cd ..

save "IHME 20200806.dta", replace





* get all countries

use "IHME 20200806.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200806.dta", replace



shell rm -r "2020_08_06"


*
***











**********************************************
**********************************************
**********************************************

* update 37
* linkdate		download		urldate
* 2020-08-21 	2020_08_21		2020-08-21 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present

clear 


di in red "This is IHME urldate 2020-08-21" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-08-21/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_08_21"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME location_id

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200821 DayDeaMeRaIHME20200821)

qui compress

cd ..

save "IHME 20200821.dta", replace





* get all countries

use "IHME 20200821.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200821.dta", replace



shell rm -r "2020_08_21"


*
***













**********************************************
**********************************************
**********************************************

* update 38
* linkdate		download		urldate
* 2020-08-27 	2020_08_27		2020-08-27 
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present

clear 


di in red "This is IHME urldate 2020-08-27" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-08-27/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd "2020_08_27"

import delimited using "Reference_hospitalization_all_locs.csv", clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed 
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name DayDeaMeSmIHME DayDeaMeRaIHME location_id

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200827 DayDeaMeRaIHME20200827)

qui compress

cd ..

save "IHME 20200827.dta", replace





* get all countries

use "IHME 20200827.dta", clear


* * Georgia and Cote d'Ivoire accounted for in lines above.


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200827.dta", replace



shell rm -r "2020_08_27"


*
***






















**********************************************
**********************************************
**********************************************

**********************************************
**********************************************
**********************************************

**********************************************
**********************************************
**********************************************

**********************************************
**********************************************
**********************************************

**********************************************
**********************************************
**********************************************

* update 39
* linkdate	download	urldate
* 03-Sep-20	2020_09_02	2020-09-03	
* filename Reference_hospitalization_all_locs.csv
* cd

* location "Global: is added. 

* Country of Georgia present, Cote d'Ivoire yet present, location_id present

clear 


di in red "This is IHME urldate 2020-09-03" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-09-03/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_09_02

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"






*** account for Georgia and Cote d'Ivoire


* The country Georgia, not the Georgia state in USA
* The country Georgia had lower daily deaths compared with the Georgia state in USA

tab DayDeaMeRaIHME if location_name == "Georgia" & date == td(01Sep2020)

tab DayDeaMeRaIHME location_id if location_name == "Georgia" & date == td(01Sep2020)

drop if location_id == 533 // the Georgia state in USA



tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200903 DayDeaMeRaIHME20200903)

qui compress

cd ..

save "IHME 20200903.dta", replace





* get all countries

use "IHME 20200903.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20200903.dta", replace



shell rm -r "2020_09_02"


*
***














**********************************************
**********************************************
**********************************************

* update 40

* linkdate	download	urldate
* 11-Sep-20	2020_09_11	2020-09-11
* filename Reference_hospitalization_all_locs.csv
* cd

* Country of Georgia present, Cote d'Ivoire yet present, location_id present


clear 
				

di in red "This is IHME urldate 2020-09-11" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-09-11/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_09_11

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)
		
rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2		
		
		
* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME    	
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"






*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200911 DayDeaMeRaIHME20200911)

qui compress

cd ..

save "IHME 20200911.dta", replace





* get all countries

use "IHME 20200911.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200911.dta", replace



shell rm -r "2020_09_11"


*
***












**********************************************
**********************************************
**********************************************

* update 41
* linkdate	download	urldate
* 18-Sep-20	2020_09_18	2020-09-18
* filename Reference_hospitalization_all_locs.csv
* cd


clear 
				

di in red "This is IHME urldate 2020-09-18" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-09-18/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_09_18

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)
		
rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2		
		
		
* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME    	
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200918 DayDeaMeRaIHME20200918)

qui compress

cd ..

save "IHME 20200918.dta", replace




* get all countries

use "IHME 20200918.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200918.dta", replace



shell rm -r "2020_09_18"


*
***











**********************************************
**********************************************
**********************************************

* update 42
* linkdate	download	urldate
* 24-Sep-20	2020_09_24	2020-09-24
* filename Reference_hospitalization_all_locs.csv
* cd


clear 
				

di in red "This is IHME urldate 2020-09-24" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-09-24/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_09_24

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)
		
rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2		
		
		
* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME    	
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"






*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20200924 DayDeaMeRaIHME20200924)

qui compress

cd ..

save "IHME 20200924.dta", replace





* get all countries

use "IHME 20200924.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20200924.dta", replace


shell rm -r "2020_09_24"


*
***






















**********************************************
**********************************************
**********************************************

* update 43
* linkdate	download	urldate
* 02-Oct-20	2020_10_02	2020-10-02
* filename Reference_hospitalization_all_locs.csv
* cd


clear 


di in red "This is IHME urldate 2020-10-02" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-10-02/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_10_02

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)


* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2


		
		
* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201002 DayDeaMeRaIHME20201002)

qui compress

cd ..

save "IHME 20201002.dta", replace




* get all countries

use "IHME 20201002.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201002.dta", replace



shell rm -r "2020_10_02"

*
***



















**********************************************
**********************************************
**********************************************

* update 44
* linkdate	download	urldate
* 09-Oct-20	2020_10_09  2020-10-09
* filename Reference_hospitalization_all_locs.csv
* cd


clear 
				

di in red "This is IHME urldate 2020-10-09" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-10-09/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_10_09

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205





* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201009 DayDeaMeRaIHME20201009)

qui compress

cd ..

save "IHME 20201009.dta", replace





* get all countries

use "IHME 20201009.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201009.dta", replace



shell rm -r "2020_10_09"


*
***


















**********************************************
**********************************************
**********************************************

* update 45
* linkdate	download	urldate
* 15-Oct-20	2020_10_15	2020-10-15
* filename Reference_hospitalization_all_locs.csv
* cd


clear 
				

di in red "This is IHME urldate 2020-10-15" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-10-15/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_10_15

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205





* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201015 DayDeaMeRaIHME20201015)

qui compress

cd ..

save "IHME 20201015.dta", replace




* get all countries

use "IHME 20201015.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20201015.dta", replace


shell rm -r "2020_10_15"

*
***


















**********************************************
**********************************************
**********************************************

* update 46
* linkdate	download	urldate
* 22-Oct-20	2020_10_22	2020-10-22
* filename Reference_hospitalization_all_locs.csv
* cd


clear 
				

di in red "This is IHME urldate 2020-10-22" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-10-22/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_10_22

import delimited using Reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205





* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201022 DayDeaMeRaIHME20201022)

qui compress

cd ..

save "IHME 20201022.dta", replace




* get all countries

use "IHME 20201022.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201022.dta", replace



shell rm -r "2020_10_22"


*
***











**********************************************
**********************************************
**********************************************

* update 47
* linkdate	download	urldate
* 29-Oct-20	2020_10_29	2020-10-29
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2020_10_29" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-10-29/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_10_29

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201029 DayDeaMeRaIHME20201029)

qui compress

cd ..

save "IHME 20201029.dta", replace



* get all countries

use "IHME 20201029.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201029.dta", replace




shell rm -r "2020_10_29"


*
***
















**********************************************
**********************************************
**********************************************

* update 48
* linkdate	download	urldate
* 12-Nov-20	2020_11_12	2020-11-12
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2020-11-12" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-11-12/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_11_12

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201112 DayDeaMeRaIHME20201112)

qui compress

cd ..

save "IHME 20201112.dta", replace





* get all countries

use "IHME 20201112.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201112.dta", replace





shell rm -r "2020_11_12"


*
***
















**********************************************
**********************************************
**********************************************

* update 49
* linkdate	download	urldate
* 19-Nov-20	2020_11_19	2020-11-19
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2020-11-19" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-11-19/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_11_19

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201119 DayDeaMeRaIHME20201119)

qui compress

cd ..

save "IHME 20201119.dta", replace




* get all countries

use "IHME 20201119.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201119.dta", replace




shell rm -r "2020_11_19"


*
***
















**********************************************
**********************************************
**********************************************

* update 50
* linkdate	download	urldate
* 03-Dec-20	2020_12_03	2020-12-03
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2020-12-03" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-12-03/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_12_03

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201203 DayDeaMeRaIHME20201203)

qui compress

cd ..

save "IHME 20201203.dta", replace



* get all countries

use "IHME 20201203.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201203.dta", replace




shell rm -r "2020_12_03"


*
***

















**********************************************
**********************************************
**********************************************

* update 51
* linkdate	download	urldate
* 10-Dec-20	2020_12_10	2020-12-10
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2020-12-10" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-12-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_12_10

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201210 DayDeaMeRaIHME20201210)

qui compress

cd ..

save "IHME 20201210.dta", replace




* get all countries

use "IHME 20201210.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20201210.dta", replace





shell rm -r "2020_12_10"


*
***
















**********************************************
**********************************************
**********************************************

* update 52
* linkdate	download	urldate
* 17-Dec-20	2020_12_17	2020-12-17
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2020-12-17" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-12-17/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_12_17

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201217 DayDeaMeRaIHME20201217)

qui compress

cd ..

save "IHME 20201217.dta", replace



* get all countries

use "IHME 20201217.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20201217.dta", replace




shell rm -r "2020_12_17"


*
***















**********************************************
**********************************************
**********************************************

* update 53
* linkdate	download	urldate
* 23-Dec-20	2020_12_23	2020-12-23
* filename reference_hospitalization_all_locs.csv
* cd
				
				
clear

di in red "This is IHME urldate 2020-12-23" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2020-12-23/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2020_12_23

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20201223 DayDeaMeRaIHME20201223)

qui compress

cd ..

save "IHME 20201223.dta", replace




* get all countries

use "IHME 20201223.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20201223.dta", replace





shell rm -r "2020_12_23"


*
***

















**********************************************
**********************************************
**********************************************

* update 54
* linkdate	download	urldate
* 15-Jan-21	2021-01-15	2021-01-15
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-01-15" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-01-15/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021-01-15

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210115 DayDeaMeRaIHME20210115)

qui compress

cd ..

save "IHME 20210115.dta", replace




* get all countries

use "IHME 20210115.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210115.dta", replace



shell rm -r "2021-01-15"

*
***






















**********************************************
**********************************************
**********************************************

* update 55
* linkdate	download	urldate
* 22-Jan-21	2021_01_22	2021-01-22
* filename reference_hospitalization_all_locs.csv
* cd
		
		
clear

di in red "This is IHME urldate 2021-01-22" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-01-22/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_01_22

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*


keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210122 DayDeaMeRaIHME20210122)

qui compress

cd ..

save "IHME 20210122.dta", replace



* get all countries

use "IHME 20210122.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210122.dta", replace




shell rm -r "2021_01_22"


*
***


















**********************************************
**********************************************
**********************************************

* update 56
* linkdate	download	urldate
* 28-Jan-21	2021_01_28	2021-01-28
* filename reference_hospitalization_all_locs.csv
* cd
				
				
clear

di in red "This is IHME urldate 2021-01-28" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-01-28/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_01_28

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"



* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




/*

A tiny defect in IHME update 2021-01-28:

The original variable "deaths_mean_smoothed" is blank for "date" 2021-01-23, 2021-01-24, and
2021-01-25 in 69 location-dates. 

One way forward is to assume it is logical and safe to replace those blank values
with correspondent values of the original variable "deaths_mean" (that is not smoothed). 
*/

codebook DayDeaMeSmIHME

replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .

codebook DayDeaMeSmIHME





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210128 DayDeaMeRaIHME20210128)

qui compress

cd ..

save "IHME 20210128.dta", replace




* get all countries

use "IHME 20210128.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210128.dta", replace




shell rm -r "2021_01_28"


*
***










**********************************************
**********************************************
**********************************************

* update 57
* linkdate	download	urldate
* 04-Feb-21	2021_02_04	2021-02-04
* filename reference_hospitalization_all_locs.csv
* cd
				

clear
				
di in red "This is IHME urldate 2021-02-04" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-02-04/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_02_04

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)





* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210204 DayDeaMeRaIHME20210204)

qui compress

cd ..

save "IHME 20210204.dta", replace




* get all countries

use "IHME 20210204.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210204.dta", replace





shell rm -r "2021_02_04"


*
***






















**********************************************
**********************************************
**********************************************

* update 58
* linkdate	download	urldate
* 12-Feb-21	2021_02_12	2021-02-12
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-02-12" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-02-12/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_02_12

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*





*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205






keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210212 DayDeaMeRaIHME20210212)

qui compress

cd ..

save "IHME 20210212.dta", replace




* get all countries

use "IHME 20210212.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210212.dta", replace



shell rm -r "2021_02_12"


*
***

















**********************************************
**********************************************
**********************************************

* update 59
* linkdate	download	urldate
* 20-Feb-21	2021_02_20	2021-02-20
* filename reference_hospitalization_all_locs.csv
* cd
		
clear		

di in red "This is IHME urldate 2021-02-20" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-02-20/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_02_20

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*






keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210220 DayDeaMeRaIHME20210220)

qui compress

cd ..

save "IHME 20210220.dta", replace




* get all countries

use "IHME 20210220.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210220.dta", replace





shell rm -r "2021_02_20"


*
***














**********************************************
**********************************************
**********************************************

* update 60
* linkdate	download	urldate
* 25-Feb-21	2021_02_25	2021-02-25
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-02-25" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-02-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_02_25

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*




keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210225 DayDeaMeRaIHME20210225)

qui compress

cd ..

save "IHME 20210225.dta", replace




* get all countries

use "IHME 20210225.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210225.dta", replace




shell rm -r "2021_02_25"


*
***















**********************************************
**********************************************
**********************************************

* update 61
* linkdate	download	urldate
* 06-Mar-21	2021_03_06	2021-03-06
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-03-06" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-03-06/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_03_06

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210306 DayDeaMeRaIHME20210306)

qui compress

cd ..

save "IHME 20210306.dta", replace




* get all countries

use "IHME 20210306.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210306.dta", replace



shell rm -r "2021_03_06"



*
***















**********************************************
**********************************************
**********************************************

* update 62
* linkdate	download	urldate
* 11-Mar-21	2021_03_11	2021-03-11
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-03-11" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-03-11/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_03_11

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210311 DayDeaMeRaIHME20210311)

qui compress

cd ..

save "IHME 20210311.dta", replace




* get all countries

use "IHME 20210311.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210311.dta", replace



shell rm -r "2021_03_11"


*
***


















**********************************************
**********************************************
**********************************************

* update 63
* linkdate	download	urldate
* 17-Mar-21	2021_03_17	2021-03-17
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-03-17" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-03-17/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_03_17

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210317 DayDeaMeRaIHME20210317)

qui compress

cd ..

save "IHME 20210317.dta", replace





* get all countries

use "IHME 20210317.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210317.dta", replace




shell rm -r "2021_03_17"


*
***












**********************************************
**********************************************
**********************************************

* update 64
* linkdate	download	urldate
* 25-Mar-21	2021_03_25	2021-03-25
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-03-25" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-03-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_03_25

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)


 

* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210325 DayDeaMeRaIHME20210325)

qui compress

cd ..

save "IHME 20210325.dta", replace




* get all countries

use "IHME 20210325.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210325.dta", replace



shell rm -r "2021_03_25"


*
***













**********************************************
**********************************************
**********************************************

* update 65
* linkdate	download	urldate
* 01-Apr-21	2021_04_01	2021-04-01
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-04-01" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-04-01/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_04_01

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210401 DayDeaMeRaIHME20210401)

qui compress

cd ..

save "IHME 20210401.dta", replace




* get all countries

use "IHME 20210401.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210401.dta", replace



shell rm -r "2021_04_01"





*
***










**********************************************
**********************************************
**********************************************

* update 66
* linkdate	download	urldate
* 09-Apr-21	2021_04_09	2021-04-09
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-04-09" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-04-09/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_04_09

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210409 DayDeaMeRaIHME20210409)

qui compress

cd ..

save "IHME 20210409.dta", replace




* get all countries

use "IHME 20210409.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210409.dta", replace




shell rm -r "2021_04_09"



*
***









**********************************************
**********************************************
**********************************************

* update 67
* linkdate	download	urldate
* 16-Apr-21	2021-04-16	2021-04-16
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-04-16" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-04-16/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021-04-16

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210416 DayDeaMeRaIHME20210416)

qui compress

cd ..

save "IHME 20210416.dta", replace



* get all countries

use "IHME 20210416.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210416.dta", replace




             
shell rm -r "2021-04-16"



*
***










**********************************************
**********************************************
**********************************************

* update 68
* linkdate	download	urldate
* 23-Apr-21	2021_04_22	2021-04-23
*  | April 23, 2021 | 
* filename reference_hospitalization_all_locs.csv
* cd
				
clear

di in red "This is IHME urldate 2021-04-23" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-04-23/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_04_22

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210423 DayDeaMeRaIHME20210423)

qui compress

cd ..

save "IHME 20210423.dta", replace



* get all countries

use "IHME 20210423.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210423.dta", replace





shell rm -r "2021_04_22"













**********************************************
**********************************************
**********************************************

* April 30, 2021 
* The reference scenario "reference_hospitalization_all_locs.csv" 
* was omitted from IHME website after original release. 










**********************************************
**********************************************
**********************************************

* update 69
* linkdate	download	urldate
* 06-May-21	2021-05-06	2021-05-06
* filename reference_hospitalization_all_locs.csv
* cd 

clear 
				
di in red "This is IHME urldate 2021-05-06" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-05-06/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021-05-06


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210506 DayDeaMeRaIHME20210506)

qui compress

cd ..

save "IHME 20210506.dta", replace




* get all countries

use "IHME 20210506.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210506.dta", replace



shell rm -r "2021-05-06"












**********************************************
**********************************************
**********************************************

* update 70
* linkdate	download		urldate
* 14-May-21	ihme-covid19	2021-05-14
* filename reference_hospitalization_all_locs.csv


clear 	

di in red "This is IHME urldate 2021-05-14" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-05-14/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210514 DayDeaMeRaIHME20210514)

qui compress

// cd ..

save "IHME 20210514.dta", replace




* get all countries

use "IHME 20210514.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210514.dta", replace














**********************************************
**********************************************
**********************************************


* update 71  
	
* linkdate	linkdate	download		urldate
* 20210521	21-May-21	ihme-covid19	2021-05-21



clear 	

di in red "This is IHME urldate 2021-05-21" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-05-21/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210521 DayDeaMeRaIHME20210521)

qui compress

// cd ..

save "IHME 20210521.dta", replace




* get all countries

use "IHME 20210521.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210521.dta", replace



***













**********************************************
**********************************************
**********************************************


* update 72	
	
* linkdate	linkdate	download		urldate
* 20210528	28-May-21	ihme-covid19	2021-05-28



clear 	

di in red "This is IHME urldate 2021-05-28" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-05-28/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210528 DayDeaMeRaIHME20210528)

qui compress

// cd ..

save "IHME 20210528.dta", replace




* get all countries

use "IHME 20210528.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210528.dta", replace



***
*











**********************************************
**********************************************
**********************************************


* update 73		

* linkdate	linkdate	download		urldate
* 20210604	04-Jun-21	ihme-covid19	2021-06-04



clear 	

di in red "This is IHME urldate 2021-06-04" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-06-04/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)





* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210604 DayDeaMeRaIHME20210604)

qui compress

// cd ..

save "IHME 20210604.dta", replace



* get all countries

use "IHME 20210604.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210604.dta", replace




***
*











**********************************************
**********************************************
**********************************************


* update 74	
	
* linkdate	linkdate	download		urldate
* 20210610	10-Jun-21	ihme-covid19	2021-06-10



clear 	

di in red "This is IHME urldate 2021-06-10" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-06-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210610 DayDeaMeRaIHME20210610)

qui compress

// cd ..

save "IHME 20210610.dta", replace




* get all countries

use "IHME 20210610.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210610.dta", replace



***
*












**********************************************
**********************************************
**********************************************


* update 75		

* linkdate	linkdate	download		urldate
* 20210618	18-Jun-21	ihme-covid19	2021-06-18


/*
Command -cd- not needed (and is harmful) because the downloaded data files are from 
a zipped file without including a directory. 

The command -cd- is needed when the downloaded data files are from a zipped file 
where the files are first enveloped by a directory and then the directory is zipped.
*/


clear 	

di in red "This is IHME urldate 2021-06-18" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-06-18/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)






* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210618 DayDeaMeRaIHME20210618)

qui compress

// cd .. // not needed

save "IHME 20210618.dta", replace



* get all countries

use "IHME 20210618.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210618.dta", replace





***
*








**********************************************
**********************************************
**********************************************


* update 76		

* linkdate	linkdate	download		urldate
* 20210625	25-Jun-21	ihme-covid19	2021-06-25



clear 	

di in red "This is IHME urldate 2021-06-25" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-06-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210625 DayDeaMeRaIHME20210625)

qui compress

// cd ..

save "IHME 20210625.dta", replace




* get all countries

use "IHME 20210625.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210625.dta", replace


***
*










**********************************************
**********************************************
**********************************************


* update 77		

* linkdate	linkdate	download		urldate
* 20210702	02-Jul-21	ihme-covid19	2021-07-02



clear 	

di in red "This is IHME urldate 2021-07-02" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-07-02/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210702 DayDeaMeRaIHME20210702)

qui compress

// cd ..

save "IHME 20210702.dta", replace




* get all countries

use "IHME 20210702.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210702.dta", replace


***
*











**********************************************
**********************************************
**********************************************


* update 78	

* linkdate	linkdate	download		urldate
* 20210715	15-Jul-21	ihme-covid19	2021-07-15



clear 	

di in red "This is IHME urldate 2021-07-15" 

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-07-15/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210715 DayDeaMeRaIHME20210715)

qui compress

// cd ..

save "IHME 20210715.dta", replace



* get all countries

use "IHME 20210715.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210715.dta", replace




***
*









**********************************************
**********************************************
**********************************************

* update 79
* linkdate	download		urldate
* 20210725	ihme-covid19	2021-07-23
* linkdate != urldate; linkdate is 20210725, urldate is 2021-07-23
* filename reference_hospitalization_all_locs.csv 


		
clear

di in red "This is IHME urldate 2021-07-25, update 20210723" 


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-07-25/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)





* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210723 DayDeaMeRaIHME20210723)

qui compress

// cd ..

save "IHME 20210723.dta", replace



* get all countries

use "IHME 20210723.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210723.dta", replace




***
*









**********************************************
**********************************************
**********************************************

* update 80
* linkdate	download		urldate
* 20210731	ihme-covid19	2021-07-31
* linkdate != urldate; 20210730, 2021-07-31
* filename reference_hospitalization_all_locs.csv 

		
clear

di in red "This is IHME urldate 2021-07-31, update 20210730"


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-07-31/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210730 DayDeaMeRaIHME20210730)

qui compress

// cd ..

save "IHME 20210730.dta", replace




* get all countries

use "IHME 20210730.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210730.dta", replace




*
***













**********************************************
**********************************************
**********************************************

* update 81
* linkdate	download	urldate
* 20210806	2021_08_04	2021-08-09
* filename reference_hospitalization_all_locs.csv 
* cd 
* cd: If the individual data files have been zipped together, downloading the zipped file (i.e., ihme-covid19.zip) 
*   results in individual data files being placed in the present working directory (-pwd-), i.e., |code|IHME| here). 
*   No -cd- is needed. On the other hand, if a directory containing the individual data files has been zipped, 
*   downloading the zipped file results in the unzipped directory (e.g. |2020_06_24.02|) 
*   being placed in the present working directory. Therefore, -cd- down to that directory 
*   (and -cd ..- at the end before saving the final file) is needed. 

		
clear

di in red "This is IHME urldate 2021-08-09, update 20210806"


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-08-09/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip

cd 2021_08_04

import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210806 DayDeaMeRaIHME20210806)

qui compress

cd ..

save "IHME 20210806.dta", replace




* get all countries

use "IHME 20210806.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210806.dta", replace


shell rm -r "2021_08_04" 


*
***












**********************************************
**********************************************
**********************************************

* update 82
* linkdate	download		urldate
* 20210820	ihme-covid19	2021-08-23
* filename reference_hospitalization_all_locs.csv 


		
clear

di in red "This is IHME urldate 2021-08-23, update 20210820"


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-08-23/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210820 DayDeaMeRaIHME20210820)

qui compress

// cd ..

save "IHME 20210820.dta", replace




* get all countries

use "IHME 20210820.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210820.dta", replace





*
***













**********************************************
**********************************************
**********************************************

* update 83
* linkdate	download	urldate
* 26-Aug-21	ihme-covid19	2021-08-26
* filename reference_hospitalization_all_locs.csv 


		
clear

di in red "This is IHME urldate 2021-08-26"


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-08-26/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)





* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210826 DayDeaMeRaIHME20210826)

qui compress

// cd ..

save "IHME 20210826.dta", replace



* get all countries

use "IHME 20210826.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210826.dta", replace





*
***










**********************************************
**********************************************
**********************************************

* update 84
* linkdate	download		urldate
* 20210902	ihme-covid19 	2021-09-17
* yes, yes, it is true that: linkdate = 20210902 but urldate = 2021-09-17
***************************************************************************************************
* filename reference_hospitalization_all_locs.csv 

		
clear

di in red "This is IHME urldate 2021-09-17, update 20210902"


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-09-17/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)



* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210902 DayDeaMeRaIHME20210902)

qui compress

// cd ..

save "IHME 20210902.dta", replace




* get all countries

use "IHME 20210902.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210902.dta", replace






*
***












**********************************************
**********************************************
**********************************************

* update 85
* linkdate	download	urldate
* 20210910	ihme-covid19	2021-09-14
* filename reference_hospitalization_all_locs.csv 


clear

di in red "This is IHME urldate 2021-09-14, update 20210910"


copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-09-14/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


import delimited using reference_hospitalization_all_locs.csv, clear varnames(1)




* gen date 

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2




* rename variables


* Daily Deaths smoothed
rename deaths_mean_smoothed  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Deaths Mean smoothed IHME S1"


* Daily Deaths not smoothed
rename deaths_mean  DayDeaMeRaIHME
label var DayDeaMeRaIHME "Daily Deaths Mean not smoothed IHME S1"


replace DayDeaMeSmIHME = DayDeaMeRaIHME if DayDeaMeSmIHME == .




*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
*



keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME DayDeaMeRaIHME deaths_data_type 

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210910 DayDeaMeRaIHME20210910)

qui compress

// cd ..

save "IHME 20210910.dta", replace



* get all countries

use "IHME 20210910.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20210910.dta", replace





*
***













**********************************************
**********************************************
**********************************************

* update 86 
* linkdate = urldate
* linkdate	download	urldate
* 16-Sep-21	ihme-covid19	2021-09-16
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-09-16"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-09-16/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip





******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210916 DayDeaMeRaIHME20210916)

order date location_name DayDeaMeSmIHME20210916

sort location_name date


qui compress

save "IHME 20210916.dta", replace




* get all countries

use "IHME 20210916.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210916.dta", replace









shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****













**********************************************
**********************************************
**********************************************

* update 87
* linkdate = urldate
* linkdate	download	urldate
* 23-Sep-21	ihme-covid19	2021-09-23
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-09-23"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-09-23/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		




* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210923 DayDeaMeRaIHME20210923)

order date location_name DayDeaMeSmIHME20210923

sort location_name date


qui compress

save "IHME 20210923.dta", replace




* get all countries

use "IHME 20210923.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210923.dta", replace






shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****



















**********************************************
**********************************************
**********************************************

* update 88
* linkdate != urldate; linkdate is 20210930, urldate is 2021-10-01
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-10-01" " update 20210930"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-10-01/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20210930 DayDeaMeRaIHME20210930)

order date location_name DayDeaMeSmIHME20210930

sort location_name date


qui compress

save "IHME 20210930.dta", replace




* get all countries

use "IHME 20210930.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20210930.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****




















**********************************************
**********************************************
**********************************************

* update 89
* linkdate = urldate
* linkdate	download		urldate
* 15-Oct-21	ihme-covid19	2021-10-15
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-10-15" " update 20211015"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-10-15/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20211015 DayDeaMeRaIHME20211015)

order date location_name DayDeaMeSmIHME20211015

sort location_name date


qui compress

save "IHME 20211015.dta", replace




* get all countries

use "IHME 20211015.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20211015.dta", replace







shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****







**********************************************
**********************************************
**********************************************

* update 90
* linkdate = urldate
* linkdate	download		urldate
* 21-Oct-21	ihme-covid19	2021-10-21
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-10-21" " update 20211021"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-10-21/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20211021 DayDeaMeRaIHME20211021)

order date location_name DayDeaMeSmIHME20211021

sort location_name date


qui compress

save "IHME 20211021.dta", replace




* get all countries

use "IHME 20211021.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20211021.dta", replace






shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****









**********************************************
**********************************************
**********************************************

* update 91
* linkdate = urldate
* linkdate	download		urldate
* 04-Nov-21	ihme-covid19	2021-11-04
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-11-04" " update 20211104"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-11-04/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20211104 DayDeaMeRaIHME20211104)

order date location_name DayDeaMeSmIHME20211104

sort location_name date


qui compress

save "IHME 20211104.dta", replace



* get all countries

use "IHME 20211104.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20211104.dta", replace







shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****








**********************************************
**********************************************
**********************************************

* update 92
* linkdate = urldate
* linkdate		download		urldate
* 2021-11-19 	ihme-covid19	2021-11-19
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-11-19" " update 20211119"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-11-19/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20211119 DayDeaMeRaIHME20211119)

order date location_name DayDeaMeSmIHME20211119

sort location_name date


qui compress

save "IHME 20211119.dta", replace




* get all countries

use "IHME 20211119.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20211119.dta", replace






shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****



















**********************************************
**********************************************
**********************************************

* update 93
* linkdate = urldate
* linkdate	download		urldate
* 21-Dec-21	ihme-covid19	2021-12-21
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2021-12-21" " update 20211221"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2021-12-21/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20211221 DayDeaMeRaIHME20211221)

order date location_name DayDeaMeSmIHME20211221

sort location_name date


qui compress

save "IHME 20211221.dta", replace




* get all countries

use "IHME 20211221.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20211221.dta", replace







shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****










**********************************************
**********************************************
**********************************************

* update 94
* linkdate = urldate
* linkdate	download		urldate
* 08-Jan-22	ihme-covid19	2022-01-08
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2022-01-10" " update 20220108"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-01-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220108 DayDeaMeRaIHME20220108)

order date location_name DayDeaMeSmIHME20220108

sort location_name date


qui compress

save "IHME 20220108.dta", replace



* get all countries

use "IHME 20220108.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20220108.dta", replace







shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****












**********************************************
**********************************************
**********************************************

* update 95
* linkdate = urldate
* linkdate	download		urldate
* 14-Jan-22	ihme-covid19	2022-01-14
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2022-01-14" " update 20220114"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-01-14/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace



******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 

append using "data_download_file_reference_2020.dta"



* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220114 DayDeaMeRaIHME20220114)

order date location_name DayDeaMeSmIHME20220114

sort location_name date


qui compress

save "IHME 20220114.dta", replace




* get all countries

use "IHME 20220114.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20220114.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****











**********************************************
**********************************************
**********************************************

* update 96
* linkdate = urldate
* linkdate	download		urldate
* 21-Jan-22	ihme-covid19	2022-01-21
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv



clear	

di in red "This is IHME urldate " "2022-01-21" " update 20220121"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-01-21/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 





append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220121 DayDeaMeRaIHME20220121)

order date location_name DayDeaMeSmIHME20220121

sort location_name date


qui compress

save "IHME 20220121.dta", replace




* get all countries

use "IHME 20220121.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20220121.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****



















**********************************************
**********************************************
**********************************************

* update 97
* linkdate = urldate
* linkdate	download		urldate
* 04-Feb-22	ihme-covid19	2022-02-04
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-02-04" " update 20220204"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-02-04/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220204 DayDeaMeRaIHME20220204)

order date location_name DayDeaMeSmIHME20220204

sort location_name date


qui compress

save "IHME 20220204.dta", replace




* get all countries

use "IHME 20220204.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20220204.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****













**********************************************
**********************************************
**********************************************

* update 98
* linkdate = urldate
* linkdate	download		urldate
* 18-Feb-22	ihme-covid19	2022-02-18
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-02-18" " update 20220218"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-02-18/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220218 DayDeaMeRaIHME20220218)

order date location_name DayDeaMeSmIHME20220218

sort location_name date


qui compress

save "IHME 20220218.dta", replace




* get all countries

use "IHME 20220218.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20220218.dta", replace




shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****












**********************************************
**********************************************
**********************************************

* update 99
* linkdate = urldate
* linkdate	download		urldate
* 21-Mar-22	ihme-covid19	2022-03-22
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-03-22" " update 20220321"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-03-22/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220321 DayDeaMeRaIHME20220321)

order date location_name DayDeaMeSmIHME20220321

sort location_name date


qui compress

save "IHME 20220321.dta", replace






* get all countries

use "IHME 20220321.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205



keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20220321.dta", replace




shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****
















**********************************************
**********************************************
**********************************************

* update 100
* linkdate = urldate
* linkdate	download		urldate
* 08-Apr-22	ihme-covid19	2022-04-08
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-04-08" " update 20220408"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-04-08/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220408 DayDeaMeRaIHME20220408)

order date location_name DayDeaMeSmIHME20220408

sort location_name date


qui compress

save "IHME 20220408.dta", replace




* get all countries

use "IHME 20220408.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20220408.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****















**********************************************
**********************************************
**********************************************

* update 101
* linkdate = urldate
* linkdate	download		urldate
* 06-May-22	ihme-covid19	2022-05-18
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-05-18" " update 20220506"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-05-18/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220506 DayDeaMeRaIHME20220506)

order date location_name DayDeaMeSmIHME20220506

sort location_name date


qui compress

save "IHME 20220506.dta", replace




* get all countries

use "IHME 20220506.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"



qui compress

save "IHME all countries 20220506.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"

****











**********************************************
**********************************************
**********************************************

* update 102
* linkdate = urldate
* linkdate	download		urldate
* 10-Jun-22	ihme-covid19	2022-06-10
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-06-10" " update 20220610"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-06-10/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2020

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2021

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2022

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME population_*

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220610 DayDeaMeRaIHME20220610)

order date location_name DayDeaMeSmIHME20220610

sort location_name date


qui compress

save "IHME 20220610.dta", replace




* get all countries

use "IHME 20220610.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20220610.dta", replace





shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_worse_2020.csv"
shell rm -r "data_download_file_worse_2021.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.dta"



****


















**********************************************
**********************************************
**********************************************

* update 103
* linkdate = urldate
* linkdate		download		urldate
* July 19, 2022	ihme-covid19	2022-07-19
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-07-19" " update 2022-07-19"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-07-19/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2020

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2021

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2022

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME population_*

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220719 DayDeaMeRaIHME20220719)

order date location_name DayDeaMeSmIHME20220719

sort location_name date


qui compress

save "IHME 20220719.dta", replace




* get all countries

use "IHME 20220719.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20220719.dta", replace


















**********************************************
**********************************************
**********************************************

* update 104
* linkdate = urldate
* linkdate				download		urldate
* September 12, 2022	ihme-covid19	2022-09-12
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-09-12" " update 2022-09-12"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-09-12/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2020

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2021

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2022

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME population_*

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20220912 DayDeaMeRaIHME20220912)

order date location_name DayDeaMeSmIHME20220912

sort location_name date


qui compress

save "IHME 20220912.dta", replace




* get all countries

use "IHME 20220912.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20220912.dta", replace








**********************************************
**********************************************
**********************************************

* update 105 
* linkdate = urldate
* linkdate				download		urldate
* October 24, 2022		ihme-covid19	2022-10-24
* filename data_download_file_reference_2020.csv and data_download_file_reference_2021.csv
*          and data_download_file_reference_2022.csv


clear	

di in red "This is IHME urldate " "2022-10-24" " update 2022-10-24"

*****************************

* get IHME estimates

copy https://ihmecovid19storage.blob.core.windows.net/archive/2022-10-24/ihme-covid19.zip ihme-covid19.zip
unzipfile ihme-covid19.zip, replace
erase ihme-covid19.zip


******************************

* import csv files

import delimited using data_download_file_reference_2020.csv, clear varnames(1)
save data_download_file_reference_2020.dta, replace

import delimited using data_download_file_reference_2021.csv, clear varnames(1)
save data_download_file_reference_2021.dta, replace

import delimited using data_download_file_reference_2022.csv, clear varnames(1)
save data_download_file_reference_2022.dta, replace


******************************

* gen scenario dta files

use "data_download_file_reference_2020.dta", clear 

local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2020

save "data_download_file_reference_2020.dta", replace 



use "data_download_file_reference_2021.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2021

save "data_download_file_reference_2021.dta", replace 





use "data_download_file_reference_2022.dta", clear 


local varlist reff_mean reff_lower reff_upper infection_fatality infection_detection infection_hospitalization

foreach v of local varlist {
	capture confirm numeric variable `v'
    if !_rc {
		di "`v'" " is numeric"
    }
    else {
		di "`v'" " contains string"
		replace `v' = "." if `v' == "Inf"
		destring `v', replace 
    }
}
*

capture rename population population_2022

save "data_download_file_reference_2022.dta", replace 




append using "data_download_file_reference_2021.dta"

append using "data_download_file_reference_2020.dta"




* gen date

rename date date_original
gen year = substr(date_original,1,4) 
gen month = substr(date_original,6,2) 
gen day = substr(date_original,9,2) 
egen date2 = concat(day month year)
gen date = date(date2, "DMY", 2050)
format date %tdDDMonCCYY
codebook date
drop year month day date2



* rename variables


* Daily Reported Deaths smoothed
rename seir_daily_unscaled_mean  DayDeaMeSmIHME
label var DayDeaMeSmIHME "Daily Reported Deaths Mean smoothed IHME S1" // Daily reported deaths (mean estimate)
		
		
		
		



*** account for Georgia and Cote d'Ivoire

tab location_id if location_name == "Georgia"

drop if location_id == 533 // state of Georgia

tab location_id if regexm(location_name,"Ivoire") == 1

replace location_name = "Cote d'Ivoire" if location_id == 205







* Check for variable deaths_data_type

capture confirm var deaths_data_type
		
if c(rc) == 0 {
	di "Variable FOUND:  " "deaths_data_type"
}
	
else if c(rc) == 111 {    // VARIABLE NOT FOUND
	di in red "Variable NOT Found:  " "deaths_data_type"
}	
* 		
		
		

rename daily_deaths_unscaled DayDeaMeRaIHME

label var DayDeaMeRaIHME "IHME Daily Deaths raw data without excess mortality scalar applied Reference scenario"
		
		
keep date location_name location_id DayDeaMeSmIHME DayDeaMeRaIHME population_*

rename (DayDeaMeSmIHME DayDeaMeRaIHME) (DayDeaMeSmIHME20221024 DayDeaMeRaIHME20221024)

order date location_name DayDeaMeSmIHME20221024

sort location_name date


qui compress

save "IHME 20221024.dta", replace




* get all countries

use "IHME 20221024.dta", clear


drop if location_id == 533 // the Georgia state in USA

replace location_name = "Côte d'Ivoire" if location_id == 205


keep if ///
location_name == "Afghanistan" | ///
location_name == "Albania" | ///
location_name == "Albania" | ///
location_name == "Algeria" | ///
location_name == "Andorra" | ///
location_name == "Angola" | ///
location_name == "Argentina" | ///
location_name == "Armenia" | ///
location_name == "Australia" | ///
location_name == "Austria" | ///
location_name == "Azerbaijan" | ///
location_name == "Bahamas" | ///
location_name == "Bahrain" | ///
location_name == "Bangladesh" | ///
location_name == "Barbados" | ///
location_name == "Belarus" | ///
location_name == "Belgium" | ///
location_name == "Belize" | ///
location_name == "Benin" | ///
location_name == "Bolivia (Plurinational State of)" | ///
location_name == "Bosnia and Herzegovina" | ///
location_name == "Botswana" | ///
location_name == "Brazil" | ///
location_name == "Bulgaria" | ///
location_name == "Burkina Faso" | ///
location_name == "Côte d'Ivoire" | /// 
location_name == "Cabo Verde" | ///
location_name == "Cambodia" | ///
location_name == "Cameroon" | ///
location_name == "Canada" | ///
location_name == "Central African Republic" | ///
location_name == "Chad" | ///
location_name == "Chile" | ///
location_name == "China" | ///
location_name == "Colombia" | ///
location_name == "Comoros" | ///
location_name == "Congo" | ///
location_name == "Costa Rica" | ///
location_name == "Croatia" | ///
location_name == "Cuba" | ///
location_name == "Cyprus" | ///
location_name == "Czechia" | ///
location_name == "Democratic Republic of the Congo" | ///
location_name == "Denmark" | ///
location_name == "Djibouti" | ///
location_name == "Dominican Republic" | ///
location_name == "Ecuador" | ///
location_name == "Egypt" | ///
location_name == "El Salvador" | ///
location_name == "Equatorial Guinea" | ///
location_name == "Estonia" | ///
location_name == "Eswatini" | ///
location_name == "Ethiopia" | ///
location_name == "Fiji" | ///
location_name == "Finland" | ///
location_name == "France" | ///
location_name == "Gabon" | ///
location_name == "Gambia" | location_name == "Georgia" | ///
location_name == "Germany" | ///
location_name == "Ghana" | ///
location_name == "Greece" | ///
location_name == "Guam" | ///
location_name == "Guatemala" | ///
location_name == "Guinea" | ///
location_name == "Guinea-Bissau" | ///
location_name == "Guyana" | ///
location_name == "Haiti" | ///
location_name == "Honduras" | ///
location_name == "Hungary" | ///
location_name == "Iceland" | ///
location_name == "India" | ///
location_name == "Indonesia" | ///
location_name == "Iran (Islamic Republic of)" | ///
location_name == "Iraq" | ///
location_name == "Israel" | ///
location_name == "Italy" | ///
location_name == "Jamaica" | ///
location_name == "Japan" | ///
location_name == "Jordan" | ///
location_name == "Kazakhstan" | ///
location_name == "Kenya" | ///
location_name == "Kuwait" | ///
location_name == "Kyrgyzstan" | ///
location_name == "Latvia" | ///
location_name == "Lebanon" | ///
location_name == "Lesotho" | ///
location_name == "Liberia" | ///
location_name == "Libya" | ///
location_name == "Lithuania" | ///
location_name == "Luxembourg" | ///
location_name == "Madagascar" | ///
location_name == "Malawi" | ///
location_name == "Malaysia" | ///
location_name == "Maldives" | ///
location_name == "Mali" | ///
location_name == "Malta" | ///
location_name == "Mauritania" | ///
location_name == "Mauritius" | ///
location_name == "Mexico" | ///
location_name == "Mongolia" | ///
location_name == "Montenegro" | ///
location_name == "Morocco" | ///
location_name == "Mozambique" | ///
location_name == "Myanmar" | ///
location_name == "Namibia" | ///
location_name == "Nepal" | ///
location_name == "Netherlands" | ///
location_name == "New Zealand" | ///
location_name == "Nicaragua" | ///
location_name == "Niger" | ///
location_name == "Nigeria" | ///
location_name == "North Macedonia" | ///
location_name == "Norway" | ///
location_name == "Oman" | ///
location_name == "Pakistan" | ///
location_name == "Palestine" | ///
location_name == "Panama" | ///
location_name == "Papua New Guinea" | ///
location_name == "Paraguay" | ///
location_name == "Peru" | ///
location_name == "Philippines" | ///
location_name == "Poland" | ///
location_name == "Portugal" | ///
location_name == "Puerto Rico" | ///
location_name == "Qatar" | ///
location_name == "Republic of Korea" | ///
location_name == "Republic of Moldova" | ///
location_name == "Romania" | ///
location_name == "Russian Federation" | ///
location_name == "Rwanda" | ///
location_name == "San Marino" | ///
location_name == "Sao Tome and Principe" | ///
location_name == "Saudi Arabia" | ///
location_name == "Senegal" | ///
location_name == "Serbia" | ///
location_name == "Sierra Leone" | ///
location_name == "Singapore" | ///
location_name == "Slovakia" | ///
location_name == "Slovenia" | ///
location_name == "Somalia" | ///
location_name == "South Africa" | ///
location_name == "South Sudan" | ///
location_name == "Spain" | ///
location_name == "Sri Lanka" | ///
location_name == "Sudan" | ///
location_name == "Suriname" | ///
location_name == "Sweden" | ///
location_name == "Switzerland" | ///
location_name == "Syrian Arab Republic" | ///
location_name == "Taiwan (Province of China)" | ///
location_name == "Tajikistan" | ///
location_name == "Thailand" | ///
location_name == "Timor-Leste" | ///
location_name == "Togo" | ///
location_name == "Trinidad and Tobago" | ///
location_name == "Tunisia" | ///
location_name == "Turkey" | ///
location_name == "Uganda" | ///
location_name == "Ukraine" | ///
location_name == "United Arab Emirates" | ///
location_name == "United Kingdom" | ///
location_name == "United States of America" | ///
location_name == "United States Virgin Islands" | ///
location_name == "Uruguay" | ///
location_name == "Uzbekistan" | ///
location_name == "Venezuela (Bolivarian Republic of)" | ///
location_name == "Viet Nam" | ///
location_name == "Yemen" | ///
location_name == "Zambia" | ///
location_name == "Zimbabwe"



* change ihme country names to location_name country names

replace location_name = "Bolivia" if location_name == "Bolivia (Plurinational State of)"
replace location_name = "Cape Verde" if location_name == "Cabo Verde"
replace location_name = "Congo, DR" if location_name == "Democratic Republic of the Congo"
replace location_name = "Cote d'Ivoire" if location_name == "Côte d'Ivoire"
replace location_name = "Iran" if location_name == "Iran (Islamic Republic of)"
replace location_name = "Korea, North" if location_name == "Korea, Democratic People's Republic of"
replace location_name = "Korea, South" if location_name == "Republic of Korea"
replace location_name = "Moldova" if location_name == "Republic of Moldova"
replace location_name = "Russia" if location_name == "Russian Federation"
replace location_name = "Syria" if location_name == "Syrian Arab Republic"
replace location_name = "Taiwan" if location_name == "Taiwan (Province of China)"
replace location_name = "Venezuela" if location_name == "Venezuela (Bolivarian Republic of)"


qui compress

save "IHME all countries 20221024.dta", replace






* remove remnant not-needed files

shell rm -r "best_masks_hospitalization_all_locs.csv"
shell rm -r "data_dictionary.csv"
shell rm -r "data_download_file_best_masks_2020.csv"
shell rm -r "data_download_file_best_masks_2021.csv"
shell rm -r "data_download_file_best_masks_2022.csv"
shell rm -r "data_download_file_global_antivirals_2020.csv"
shell rm -r "data_download_file_global_antivirals_2021.csv"
shell rm -r "data_download_file_global_antivirals_2022.csv"
shell rm -r "data_download_file_reduce_hesitancy_2020.csv"
shell rm -r "data_download_file_reduce_hesitancy_2021.csv"
shell rm -r "data_download_file_reference_2020.csv"
shell rm -r "data_download_file_reference_2020.dta"
shell rm -r "data_download_file_reference_2021.csv"
shell rm -r "data_download_file_reference_2021.dta"
shell rm -r "data_download_file_reference_2022.csv"
shell rm -r "data_download_file_reference_2022.dta"
shell rm -r "data_download_file_severe_omicron_2020.csv"
shell rm -r "data_download_file_severe_omicron_2021.csv"
shell rm -r "data_download_file_third_dose_2020.csv"
shell rm -r "data_download_file_third_dose_2021.csv"
shell rm -r "data_download_file_third_dose_2022.csv"
shell rm -r "reference_hospitalization_all_locs.csv"
shell rm -r "Summary_stats_all_locs.csv"
shell rm -r "worse_hospitalization_all_locs.csv"
shell rm -r "IHME_COVID_19_Data_Release_Information_Sheet.pdf"














**************************************************************

* gen list of countries and update dates


local list ///
20200325 ///
20200326 ///
20200327 ///
20200329 ///
20200330 ///
20200331 ///
20200401 ///
20200405 ///
20200407 ///
20200408 ///
20200410 ///
20200413 ///
20200417 ///
20200421 ///
20200422 ///
20200427 ///
20200428 ///
20200429 ///
20200504 ///
20200510 ///
20200512 ///
20200520 ///
20200525 ///
20200526 ///
20200529 ///
20200605 ///
20200608 ///
20200610 ///
20200615 ///
20200625 ///
20200629 ///
20200707 ///
20200714 ///
20200722 ///
20200730 ///
20200806 ///
20200821 ///
20200827 ///
20200903 ///
20200911 ///
20200918 ///
20200924 ///
20201002 ///
20201009 ///
20201015 ///
20201022 ///
20201029 ///
20201112 ///
20201119 ///
20201203 ///
20201210 ///
20201217 ///
20201223 ///
20210115 ///
20210122 ///
20210128 ///
20210204 ///
20210212 ///
20210220 ///
20210225 ///
20210306 ///
20210311 ///
20210317 ///
20210325 ///
20210401 ///
20210409 ///
20210416 ///
20210423 ///
20210506 ///
20210514 ///
20210521 ///
20210528 ///
20210604 ///
20210610 ///
20210618 ///
20210625 ///
20210702 ///
20210715 ///
20210723 ///
20210730 ///
20210806 ///
20210820 ///
20210826 ///
20210902 ///
20210910 ///
20210916 ///
20210923 ///
20210930 ///
20211015 ///
20211021 ///
20211104 ///
20211119 ///
20211221 ///
20220108 ///
20220114 ///
20220121 ///
20220204 ///
20220218 ///
20220321 ///
20220408 ///
20220506 ///
20220610 ///
20220719 ///
20220912 ///
20221024


foreach update of local list {

	use "IHME all countries `update'.dta", clear
	
	keep location_name 
	
	rename location_name country
		
	contract country
	
	drop _freq
		
	rename country country`update'
	
	gen counter = _n
	
	save "IHME `update' countries.dta", replace

}
*



use "IHME 20200325 countries.dta" 


foreach update of local list {

	merge m:m counter using "IHME `update' countries.dta"
	
	drop _merge

}
*


order counter

qui compress 

save "IHME countries.dta", replace


*





* determine earliest date each country was present (date_present_first) 
* dates on which each country was absent (after their first presence)(date_absent_1*)

use "IHME countries.dta", clear 

rename counter obs_no

rename (country*) (countries*)

* use -fillin- in a long file:

* https://www.statalist.org/forums/forum/general-stata-discussion/general/1687043-how-to-rearrange-the-values-of-string-variables-according-to-a-criterion

reshape long countries, i(obs_no) j(str_date) string
gen int real_date = daily(str_date, "YMD")
assert missing(str_date) == missing(real_date)
format real_date %td
drop str_date

rename countries country
drop if missing(country)
fillin country real_date
rename _fillin absent
drop obs_no

by country (real_date), sort: egen date_present_first = min(cond(!absent, real_date, .))
format date_present_first %td

by country (real_date): gen absent_dates = ///
    cond(absent, string(real_date, "%tdCCYYNNDD"), "") if _n == 1
by country (real_date): replace absent_dates = ///
    absent_dates[_n-1] + cond(absent, " " + string(real_date, "%tdCCYYNNDD"), "") ///
    if _n > 1
by country (real_date): replace absent_dates = absent_dates[_N]
split absent_dates, gen(date_absent)
drop absent_dates
isid country real_date, sort

* 


gen year = year(real_date)
gen month = month(real_date)
gen day = day(real_date)
tostring year month day, replace
replace month = "01" if month == "1"
replace month = "02" if month == "2"
replace month = "03" if month == "3"
replace month = "04" if month == "4"
replace month = "05" if month == "5"
replace month = "06" if month == "6"
replace month = "07" if month == "7"
replace month = "08" if month == "8"
replace month = "09" if month == "9"
replace day = "01" if day == "1"
replace day = "02" if day == "2"
replace day = "03" if day == "3"
replace day = "04" if day == "4"
replace day = "05" if day == "5"
replace day = "06" if day == "6"
replace day = "07" if day == "7"
replace day = "08" if day == "8"
replace day = "09" if day == "9"

gen blockdate_string = year + month + day
destring blockdate_string, gen(blockdate)
drop year month day blockdate_string
order blockdate, before(real_date)

rename blockdate update_date_block
rename real_date update_date_real







gen year = year(date_present_first)
gen month = month(date_present_first)
gen day = day(date_present_first)
tostring year month day, replace
replace month = "01" if month == "1"
replace month = "02" if month == "2"
replace month = "03" if month == "3"
replace month = "04" if month == "4"
replace month = "05" if month == "5"
replace month = "06" if month == "6"
replace month = "07" if month == "7"
replace month = "08" if month == "8"
replace month = "09" if month == "9"
replace day = "01" if day == "1"
replace day = "02" if day == "2"
replace day = "03" if day == "3"
replace day = "04" if day == "4"
replace day = "05" if day == "5"
replace day = "06" if day == "6"
replace day = "07" if day == "7"
replace day = "08" if day == "8"
replace day = "09" if day == "9"

gen date_present_first_block = year + month + day
destring date_present_first_block, replace
drop year month day 
order date_present_first_block, before(date_present_first)
rename date_present_first date_present_first_real

rename country loc_grand_name 

*



* country names to country

replace loc_grand_name = "Cape Verde" if loc_grand_name == "Cabo Verde" 
replace loc_grand_name = "Guinea Bissau" if loc_grand_name == "Guinea-Bissau" 
replace loc_grand_name = "Korea South" if loc_grand_name == "Korea, South" 


isid loc_grand_name update_date_block, sort



qui compress

save "IHME countries long.dta", replace











**********************

view "log CovidLongitudinal IHME.smcl"

log close

exit, clear
